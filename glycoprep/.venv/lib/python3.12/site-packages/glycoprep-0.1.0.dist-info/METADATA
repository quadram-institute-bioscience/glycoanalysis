Metadata-Version: 2.4
Name: glycoprep
Version: 0.1.0
Summary: Glycan mass spectrometry preprocessing pipeline
Author: CoreBioInfo
License: MIT
Project-URL: Homepage, https://github.com/CoreBioInfo/glycoprep
Project-URL: Repository, https://github.com/CoreBioInfo/glycoprep
Keywords: glycomics,mass-spectrometry,MALDI-TOF,preprocessing
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Science/Research
Classifier: Topic :: Scientific/Engineering :: Bio-Informatics
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: pandas>=2.0
Requires-Dist: openpyxl>=3.1
Requires-Dist: click>=8.0
Requires-Dist: rich>=13.0
Requires-Dist: rich-click>=1.7
Requires-Dist: numpy>=1.24
Provides-Extra: dev
Requires-Dist: pytest>=7.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0; extra == "dev"
Requires-Dist: ruff>=0.1; extra == "dev"

# glycoprep

Glycan mass spectrometry preprocessing pipeline for MALDI-TOF data.

## Features

- Match MALDI-TOF peaks to reference glycan database using PPM tolerance
- Automatic detection of systematic calibration shifts per sample
- Output both raw and corrected PPM differences
- Confidence scoring based on PPM proximity
- Separate output for unmatched peaks

## Installation

```bash
cd glycoprep
pip install -e .
```

## Usage

```bash
glycoprep -i raw_data.xlsx -m metadata.xlsx -d glycan_db.xlsx
```

### Options

| Option | Description | Default |
|--------|-------------|---------|
| `-i, --input-peaks` | Input Excel with MALDI peaks (sheet per sample) | Required |
| `-m, --metadata` | Metadata Excel linking sheets to conditions | Required |
| `-d, --glycans-db` | Reference glycan database | Required |
| `-o, --output` | Output TSV for matched peaks | `matched_glycans.tsv` |
| `--unmatched-output` | Output TSV for unmatched peaks | `unmatched_peaks.tsv` |
| `--ppm-threshold` | PPM tolerance for matching | `100` |
| `--skip-rows` | Header rows to skip in peak files | `2` |
| `--min-sn` | Minimum signal-to-noise filter | None |

### Output Columns

**Peak data:** `sample_sheet`, `m_z`, `observed_mz`, `intens`, `sn`, `rel_intens`, etc.

**Metadata:** All columns from metadata file (patient, condition, etc.)

**Reference:** `Mass`, `Composition`, `Sialylation`, `Fucosylation`, `Sulfation`

**Computed:**
- `ppm_difference` - Raw PPM difference (signed)
- `ppm_difference_corrected` - After subtracting sample's systematic shift
- `sample_shift_estimate` - Median PPM shift for the sample
- `confidence` - Score 0-1 based on raw PPM
- `confidence_corrected` - Score 0-1 based on corrected PPM

## Calibration Shift Detection

The tool estimates systematic calibration errors by calculating the median signed PPM difference per sample. A consistent positive or negative median indicates all peaks are shifted in the same direction, suggesting instrument miscalibration.

The corrected PPM values subtract this systematic shift, improving confidence scores for well-calibrated instruments and revealing true matching quality.
